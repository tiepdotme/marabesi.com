<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">

    <title>Laravel the right way (PART 1) - 10 Laravel meetup</title>
    <meta name="description"
      content="Recently I’ve been to the Laravel meetup and I had the pleasure to talk about good pratices and common mistakes that newbies in Laravel do in the daily basis...">

    <link rel="canonical" href="https://marabesi.com/php/2016/09/13/laravel-the-right-way-part-1.html">
    <link rel="alternate" type="application/rss+xml" title="Marabesi"
      href="https://marabesi.com/feed.xml">

    <meta property="og:title" content="Laravel the right way (PART 1) - 10 Laravel meetup" />
    <meta property="og:site_name" content="marabesi.com" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://marabesi.com/php/2016/09/13/laravel-the-right-way-part-1.html" />
    <meta property="og:image"
      content="https://marabesi.com/images/posts/2016-09-13-laravel-the-right-way-part-1/cover.svg" />
    <meta property="og:description"
      content="Recently I’ve been to the Laravel meetup and I had the pleasure to talk about good pratices and common mistakes that newbies in Laravel do in the daily basis..." />

    <meta property="fb:app_id" content="536384943068161" />

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@MatheusMarabesi">
    <meta name="twitter:title" content="Laravel the right way (PART 1) - 10 Laravel meetup">
    <meta name="twitter:description"
      content="Recently I’ve been to the Laravel meetup and I had the pleasure to talk about good pratices and common mistakes that newbies in Laravel do in the daily basis...">
    <meta name="twitter:creator" content="@MatheusMarabesi">
    <meta name="twitter:image:src"
      content="https://marabesi.com/images/posts/2016-09-13-laravel-the-right-way-part-1/cover.svg">

    <meta name="keywords" content="Laravel,business,data,service,layer,right,different,application,php,laravel,right way,models,framework,laracast,laranews" />

    <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/images/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">

    <link href="/assets/main-bundle.css" rel="stylesheet" />

    <!-- See https://goo.gl/OOhYW5 -->
    <link rel="manifest" href="/manifest.json">

    <!-- See https://goo.gl/qRE0vM -->
    <meta name="theme-color" content="#3f51b5">

    <!-- Add to homescreen for Chrome on Android. Fallback for manifest.json -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Marabesi">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Marabesi">

    <!-- Homescreen icons -->
    <link rel="apple-touch-icon" href="/images/manifest/icon-48x48.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/images/manifest/icon-72x72.png">
    <link rel="apple-touch-icon" sizes="96x96" href="/images/manifest/icon-96x96.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/images/manifest/icon-144x144.png">
    <link rel="apple-touch-icon" sizes="192x192" href="/images/manifest/icon-192x192.png">

    <!-- Tile icon for Windows 8 (144x144 + tile color) -->
    <meta name="msapplication-TileImage" content="/images/manifest/icon-144x144.png">
    <meta name="msapplication-TileColor" content="#3f51b5">
    <meta name="msapplication-tap-highlight" content="no">
  </head>

  <body class="font-sans overflow-x-hidden">
    <button class="update-button w-full text-white bg-marabesi-purple p-5 m-auto fixed pin-b z-50 hidden focus:outline-none font-bold">Update found, click to update</button>

    <div class="menu-wrapper flex fixed w-full bg-white z-50">
      <nav class="top-menu hidden md:flex justify-start container lg:justify-center md:m-auto md:pt-2 md:pb-2">
        <a href="/" class="hidden md:block">
          <img class="logo w-18 p-1" data-src="/images/logo.png" width="100" alt="marabesi.com logo - two m's and one dot" title="marabesi.com logo - two m's and one dot" />
        </a>

        <ul id="menu-list" class="container-menu hidden flex-col pl-5 md:flex md:pl-0 md:flex-row md:m-auto lg:m-0">
          
           
            <li class="item pt-2 pb-2 md:p-2">
              <a class="item-link no-underline" href="/talks">
                Talks
              </a>
            </li>
          
          
           
            <li class="item pt-2 pb-2 md:p-2">
              <a class="item-link no-underline" href="/about">
                About
              </a>
            </li>
          
          
           
            <li class="item pt-2 pb-2 md:p-2">
              <a class="item-link no-underline" href="/newbie-guide">
                Dev guide
              </a>
            </li>
          
          
           
            <li class="item pt-2 pb-2 md:p-2">
              <a class="item-link no-underline" href="/resources">
                software development
              </a>
            </li>
          
          
           
            <li class="item pt-2 pb-2 md:p-2">
              <a class="item-link no-underline" href="/tests/">
                Tests
              </a>
            </li>
          
          
           
            <li class="item pt-2 pb-2 md:p-2">
              <a class="item-link no-underline" href="/calendar">
                Conferences
              </a>
            </li>
          
          
        </ul>
      </nav>

      <div class="w-full flex items-center h-12 pl-2 bg-white md:hidden">
        <svg id="menu" class="cursor-pointer w-10 h-10 p-2 text-marabesi-pink fill-current" xmlns="http://www.w3.org/2000/svg"
          x="0px" y="0px" width="50" height="50" viewBox="0 0 24 24">
          <path
            style="line-height:normal;text-indent:0;text-align:start;text-decoration-line:none;text-decoration-style:solid;text-decoration-color:#000;text-transform:none;block-progression:tb;isolation:auto;mix-blend-mode:normal"
            d="M 2 5 L 2 7 L 22 7 L 22 5 L 2 5 z M 2 11 L 2 13 L 22 13 L 22 11 L 2 11 z M 2 17 L 2 19 L 22 19 L 22 17 L 2 17 z"
            font-weight="400" font-family="sans-serif" white-space="normal" overflow="visible"></path>
        </svg>
      </div>
    </div>

    <div class="flex flex-col items-center justify-center p-5">
      <input type="text" id="search-input" placeholder="search" aria-label="search" class="focus:outline-none border border-marabesi-purple text-marabesi-purple w-full p-3 mb-2 container mt-20 lg:mt-12">
      <ul id="results-container"></ul>
    </div>

    <div class="shell-content">
      <div class="banner-highlight">
        <p class="font-normal text-lg py-4 md:text-3xl lg:text-4xl">
          <span class="apostrophe">‘‘</span>
          Code should be easy to understand.
          <span class="apostrophe">’’</span>
        </p>
        <p class="author text-xs">Dustin Boswell and Trevor Foucher - The Art Of Readable Code</p>
      </div>

        <div class="page-content container flex flex-col p-5 m-auto">
  <h1>Laravel the right way (PART 1) - 10 Laravel meetup</h1>

  <main class="mb-5">
    <p>Recently I’ve been to the <a href="http://www.meetup.com/pt-BR/Laravel-SP/events/233563455" target="_blank">Laravel meetup</a> and I had the pleasure to talk about good pratices and common
 mistakes that newbies in Laravel do in the daily basis. We  had also Guilherme Guitte’s
 talk who had spoken how elastic serach work.</p>

<h2 id="laravel-the-right-way">Laravel the right way</h2>

<p>There are a few topics that I’ve been across over and over during my daily basis as a developer using Laravel.
This bothers me because some of them are so easy to understand to use that I decided to divide it in a few 
topics and try to guide the developers to a better Laravel usage. We will be through composer packages, directory 
structures and the Laravel docs to compose this topics, so let’s dive in.</p>

<h2 id="models">Models</h2>

<p>Laravel is a framework with that give to the developer a big responsability, it gives the ability to you to free chose the location
of your models. Laravel doesn’t care if you want to place it in the root directory, divide it into sub directories or
just throw it away on the framework.
The freedom that we have is huge, and sometimes new developers doesn’t know how to handle that (or if you’re
a experienced developer you may not know what are the best place to store the files</p>

<p><img src="/images/posts/2016-09-13-laravel-the-right-way-part-1/models.png" alt="Models" title="Models" /></p>

<p>So here I present what I’ve found useful in how to handle with the models and the solution is simple, store input
in a folder called <strong>Models</strong>.</p>

<p>To keep things even better you can also create sub directories inside the <strong>Models</strong> folder, as long as it makes
sense to do it.</p>

<h2 id="models-dont-least-forever-repositories-for-the-rescue">Models don’t least forever, repositories for the rescue</h2>

<p>This topic is totally apart from Laravel’s framework base, which means that we are going to talk about
a package called l5-repository. This package is used into the Laravel’s framework to be possible to use
the repository patter.</p>

<blockquote>
  <p>It queries the data source for the data, maps the data from the data source to a business entity,
and persists changes in the business entity to the data source. A repository separates the business
logic from the interactions with the underlying data source or Web service.</p>
</blockquote>

<p>As our application grows is normal to have a lot of files, a lot of classes and many assets to handle.
It is not different with our models, in the MVC pattern we use the models to store the business logic.</p>

<p><img src="/images/posts/2016-09-13-laravel-the-right-way-part-1/model-rules.png" alt="Business rules inside a model" title="Business rules inside a model" /></p>

<p>There is nothing to fear when dealing with small applications, but if you have a application a little bit
bigger you are going to start to have many methods inside a single file. Don’t believe me? Let’s have a look
at a real application</p>

<p><img src="/images/posts/2016-09-13-laravel-the-right-way-part-1/methods.png" alt="Too many methods" title="Too many methods" /></p>

<p>What’s the problem with that? It seems perfect, right? The first problem here is the coupled access
to the data in the database, this is tighten into the models’s method. The second problem is that
if we need to reuse the code in a other method, let’s say only the where clause it would be impossible.</p>

<p>Besides the persistence layer we have coupled a few business into our models as figure above show us. We have got at
least 8 methods and by their names we can see that there are rules behind it.</p>

<h2 id="introducing-services">Introducing services</h2>

<p>My point of view in doing all of this is, ok, you have got the MVC pattern and can build your application really fine, but
there are a few gaps. The first is the project organization (should I always add the business rule inside a model? What if I have the
same rule but in a different kind? How would you use polymorphism?). The second is the size of the project, with
three main folders model-view-controller it will get too many files really quick and the last is the modularity
how would you use modules?</p>

<p><img src="/images/posts/2016-09-13-laravel-the-right-way-part-1/mvc.png" alt="regular MVC" title="regular MVC" /></p>

<p>For those reasons we could start using the service layer. The service layer is where all the business rules lives.</p>

<p>The basic approach is to build the services and the service is going to use the models, and the controllers will use
the service. This must by single direction, which means that services doesn’t uses controller otherwise there is
no point to have a layer specific to it.</p>

<p><img src="/images/posts/2016-09-13-laravel-the-right-way-part-1/mvc-service-layer.png" alt="MVC and service layer" title="MVC and service layer" /></p>

<p>The good point of using a layer service is the flexibility that i gives to you, is possible to concentrate 
the business rules inside of this layer and consume them.</p>

<p>Imagine two different controllers one, needs to return JSON to the client and the other XML, in the regular MVC
you could have two different methods inside your model, call in each controller the methods needed and everything just 
works. But one of the problems is the testability and the S.O.L.I.D violation.</p>


  </main>

  

<style>
#share-buttons {display: flex; justify-content: center; align-items: center;}
#share-buttons > div {
    position: relative;
    text-align: left; 
    height: 36px; 
    width: 32px; 
    float: left; 
    text-align: center;
}
#share-buttons > div > svg {height: 16px; fill: #f12f46; margin-top: 10px;}
#share-buttons > div:hover {cursor: pointer;}
#share-buttons > div.facebook:hover > svg {fill: #3B5998;}
#share-buttons > div.twitter:hover > svg {fill: #55ACEE;}
#share-buttons > div.linkedin:hover > svg {fill: #0077b5;}
#share-buttons > div.pinterest:hover > svg {fill: #CB2027;}
#share-buttons > div.gplus:hover > svg {fill: #dd4b39;}
#share-buttons > div.mail:hover > svg {fill: #7D7D7D;}
#share-buttons > div.instagram:hover > svg {fill: #C73B92;}
#share-buttons > div.facebook > svg {height: 18px; margin-top: 9px;}
#share-buttons > div.twitter > svg {height: 20px; margin-top: 8px;}
#share-buttons > div.linkedin > svg {height: 19px; margin-top: 7px;}
#share-buttons > div.pinterest > svg {height: 20px; margin-top: 9px;}
#share-buttons > div.gplus > svg {height: 17px; margin-top: 9px; position: relative; left: 1px;}
#share-buttons > div.mail > svg {height: 14px; margin-top: 11px;}
</style>

<div id="share-buttons" class="mb-5">
    <span>Share this on</span>
    <div class="facebook" title="Share this on Facebook" onclick="window.open('http://www.facebook.com/share.php?u=https://marabesi.com/php/2016/09/13/laravel-the-right-way-part-1.html');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1343 12v264h-157q-86 0-116 36t-30 108v189h293l-39 296h-254v759h-306v-759h-255v-296h255v-218q0-186 104-288.5t277-102.5q147 0 228 12z"/></svg></div>
    <div class="twitter" title="Share this on Twitter" onclick="window.open('https://twitter.com/intent/tweet?text=https://marabesi.com/php/2016/09/13/laravel-the-right-way-part-1.html');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1684 408q-67 98-162 167 1 14 1 42 0 130-38 259.5t-115.5 248.5-184.5 210.5-258 146-323 54.5q-271 0-496-145 35 4 78 4 225 0 401-138-105-2-188-64.5t-114-159.5q33 5 61 5 43 0 85-11-112-23-185.5-111.5t-73.5-205.5v-4q68 38 146 41-66-44-105-115t-39-154q0-88 44-163 121 149 294.5 238.5t371.5 99.5q-8-38-8-74 0-134 94.5-228.5t228.5-94.5q140 0 236 102 109-21 205-78-37 115-142 178 93-10 186-50z"/></svg></div>
    <div class="linkedin" title="Share this on Linkedin" onclick="window.open('https://www.linkedin.com/shareArticle?mini=true&url=https://marabesi.com/php/2016/09/13/laravel-the-right-way-part-1.html&title=&summary=&source=');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M477 625v991h-330v-991h330zm21-306q1 73-50.5 122t-135.5 49h-2q-82 0-132-49t-50-122q0-74 51.5-122.5t134.5-48.5 133 48.5 51 122.5zm1166 729v568h-329v-530q0-105-40.5-164.5t-126.5-59.5q-63 0-105.5 34.5t-63.5 85.5q-11 30-11 81v553h-329q2-399 2-647t-1-296l-1-48h329v144h-2q20-32 41-56t56.5-52 87-43.5 114.5-15.5q171 0 275 113.5t104 332.5z"/></svg></div>
</div>

  <div id="disqus_thread"></div>
</div>


      <div class="footer">
        <div class="footer-details">
          Designed by @tamyitokazo
        </div>
      </div>
    </div>

    
    <script>
      (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
          (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date(); a = s.createElement(o),
          m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
      })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

      ga('create', 'UA-58623708-1', 'auto');
      ga('send', 'pageview');
    </script>
    

    <script async src="/assets/main-bundle.js"></script>
  </body>
</html>